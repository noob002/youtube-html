<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YouTube 영상 검색</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #121212;
            color: white;
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        header {
            background-color: #333;
            padding: 10px 20px;
            text-align: center;
        }
        h1 {
            margin: 0;
            font-size: 24px;
        }
        .search-container {
            display: flex;
            justify-content: center;
            padding: 20px;
        }
        .search-container input {
            padding: 10px;
            font-size: 16px;
            border: 1px solid #333;
            background-color: #222;
            color: white;
            width: 300px;
        }
        .search-container button {
            padding: 10px;
            margin-left: 10px;
            background-color: #ff5722;
            color: white;
            border: none;
            cursor: pointer;
        }
        .search-container button:hover {
            background-color: #e64a19;
        }
        .results {
            display: flex;
            flex-wrap: wrap;
            justify-content: space-around;
            margin: 20px 0;
        }
        .video-card {
            background-color: #333;
            border-radius: 8px;
            overflow: hidden;
            width: 300px;
            margin: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            opacity: 0;
            transform: translateX(-100px);
            animation: slideIn 0.5s forwards;
        }
        .video-card img {
            width: 100%;
            height: auto;
            cursor: pointer;
        }
        .video-card .info {
            padding: 15px;
        }
        .video-card h3 {
            margin: 0 0 10px;
            font-size: 18px;
            cursor: pointer;
        }
        .video-card p {
            font-size: 14px;
            color: #bbb;
        }

        @keyframes slideIn {
            0% {
                opacity: 0;
                transform: translateX(-100px);
            }
            100% {
                opacity: 1;
                transform: translateX(0);
            }
        }

        /* 비디오 미리보기 스타일 */
        .video-preview {
            display: none;
            width: 300px;
            height: 169px;
            background-color: black;
            position: absolute;
            top: 0;
            left: 0;
            z-index: 10;
        }

        iframe {
            width: 100%;
            height: 100%;
        }
    </style>
</head>
<body>

<header>
    <h1>YouTube 영상 검색</h1>
</header>

<div class="search-container">
    <input type="text" id="query" placeholder="검색어를 입력하세요...">
    <button onclick="searchVideos()">검색</button>
</div>

<div class="results" id="results"></div>

<!-- 비디오 미리보기 -->
<div class="video-preview" id="videoPreview">
    <iframe id="previewIframe" src="" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
</div>

<script>
    const API_KEY = 'AIzaSyAA3kRQm_Qz63VXnaXBfrFd_I1ncVee3Js';

    async function searchVideos() {
        const query = document.getElementById('query').value.trim();

        // Easter Egg Trigger
        if (query.toLowerCase() === 'error') {
            triggerEasterEgg();
            return;
        }

        if (!query) {
            alert("검색어를 입력해주세요!");
            return;
        }

        const url = `https://www.googleapis.com/youtube/v3/search?part=snippet&q=${query}&key=${API_KEY}`;

        try {
            const response = await fetch(url);
            const data = await response.json();
            if (data.items) {
                displayVideos(data.items);
            } else {
                alert("검색 결과가 없습니다.");
            }
        } catch (error) {
            console.error('Error fetching data:', error);
            alert("데이터를 불러오는 중 오류가 발생했습니다.");
        }
    }

    function triggerEasterEgg() {
        const body = document.body;
        body.style.backgroundColor = 'red';
        body.style.color = 'white';

        // 화면 흔들림 효과
        let shaking = 0;
        const interval = setInterval(() => {
            shaking += 1;
            body.style.transform = shaking % 2 === 0 ? 'translateX(-10px)' : 'translateX(10px)';
            if (shaking > 10) {
                clearInterval(interval);
                body.style.transform = 'none';
            }
        }, 100);

        // 오류 메시지 표시
        const errorMessage = document.createElement('div');
        errorMessage.style.position = 'fixed';
        errorMessage.style.top = '50%';
        errorMessage.style.left = '50%';
        errorMessage.style.transform = 'translate(-50%, -50%)';
        errorMessage.style.backgroundColor = '#000';
        errorMessage.style.color = '#fff';
        errorMessage.style.padding = '20px';
        errorMessage.style.borderRadius = '10px';
        errorMessage.style.textAlign = 'center';
        errorMessage.style.boxShadow = '0 4px 10px rgba(0, 0, 0, 0.5)';
        errorMessage.innerHTML = `
            <h2>🤖 비밀 발견!</h2>
            <p>이건 오류가 아니라 이스터 에그입니다! 🎉</p>
        `;
        body.appendChild(errorMessage);

        // 5초 후 원래 상태로 복귀
        setTimeout(() => {
            body.style.backgroundColor = '';
            body.style.color = '';
            errorMessage.remove();
        }, 5000);
    }

    function displayVideos(videos) {
        const resultsContainer = document.getElementById('results');
        resultsContainer.innerHTML = ''; // 이전 검색 결과 지우기

        for (const video of videos) {
            const videoId = video.id.videoId;
            const title = video.snippet.title;
            const description = video.snippet.description;
            const thumbnailUrl = video.snippet.thumbnails.high.url;
            const uploadDate = video.snippet.publishedAt;
            const videoUrl = `https://www.youtube.com/watch?v=${videoId}`;

            const videoCard = document.createElement('div');
            videoCard.classList.add('video-card');

            videoCard.innerHTML = `
                <img src="${thumbnailUrl}" alt="${title}" onclick="playPreview('${videoId}')">
                <div class="info">
                    <h3 onclick="window.open('${videoUrl}', '_blank')">${title}</h3>
                    <p>${description.length > 100 ? description.substring(0, 100) + '...' : description}</p>
                    <p>업로드: ${new Date(uploadDate).toLocaleDateString()}</p>
                </div>
            `;

            resultsContainer.appendChild(videoCard);
        }
    }

    function playPreview(videoId) {
        const previewContainer = document.getElementById('videoPreview');
        const iframe = document.getElementById('previewIframe');

        // 10초 동안 자동으로 재생하고 음소거 상태로 설정
        iframe.src = `https://www.youtube.com/embed/${videoId}?autoplay=1&mute=1&start=0&end=10`;
        previewContainer.style.display = 'block';

        setTimeout(() => {
            previewContainer.style.display = 'none';
        }, 10000); // 10초 후에 자동으로 미리보기 종료
    }
</script>

</body>
</html>
