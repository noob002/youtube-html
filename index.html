<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>YouTube 영상 검색</title>
<style>
    body {
        font-family: Arial, sans-serif;
        background-color: #121212;
        color: white;
        margin: 0;
        padding: 0;
        overflow-x: hidden;
        transition: background 0.5s ease;
    }
    .day-theme {
        background: url('https://images.unsplash.com/photo-1507525428034-b723cf961d3e?auto=format&fit=crop&w=1600&q=80') no-repeat center center/cover;
    }
    .night-theme {
        background: url('https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=1600&q=80') no-repeat center center/cover;
    }
    header {
        background-color: rgba(51, 51, 51, 0.8);
        padding: 10px 20px;
        text-align: center;
    }
    h1 { margin: 0; font-size: 24px; }
    .red { color: red; cursor: pointer; }
    .search-container {
        display: flex; justify-content: center; padding: 20px; gap: 10px;
    }
    .search-container input {
        padding: 10px; font-size: 16px; border: 1px solid #333;
        background-color: #222; color: white; width: 300px;
    }
    .search-container button {
        padding: 10px; background-color: #ff5722; color: white; border: none; cursor: pointer;
    }
    .search-container button:hover { background-color: #e64a19; }
    #themeToggle {
        font-size: 20px; background-color: #333; border-radius: 50%;
        width: 40px; height: 40px; display: flex; align-items: center;
        justify-content: center; transition: transform 0.6s;
    }
    .rotating { animation: rotateIcon 0.6s ease-in-out; }
    @keyframes rotateIcon {
        0% { transform: rotateY(0deg); }
        50% { transform: rotateY(90deg); }
        100% { transform: rotateY(180deg); }
    }
    .sparkle {
        position: relative;
    }
    .sparkle::after {
        content: "✨";
        position: absolute;
        animation: sparkleAnim 1s infinite alternate;
        font-size: 12px;
        top: -5px;
        right: -5px;
    }
    @keyframes sparkleAnim {
        0% { opacity: 0.2; transform: scale(0.8) rotate(0deg); }
        100% { opacity: 1; transform: scale(1.2) rotate(20deg); }
    }
    .results {
        display: flex; flex-wrap: wrap; justify-content: center;
        padding: 20px; gap: 20px;
    }
    .video-card {
        background-color: rgba(34, 34, 34, 0.85);
        border-radius: 8px; width: 300px; overflow: hidden;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
        transition: transform 0.3s;
    }
    .video-card:hover { transform: scale(1.03); }
    .video-card img {
        width: 100%;
        height: 180px;
        object-fit: cover;
        border-bottom: 1px solid #444;
    }
    .video-card h3 {
        font-size: 18px; margin: 10px;
    }
    .video-card p {
        font-size: 14px; margin: 10px; color: #bbb;
    }
</style>
</head>
<body class="day-theme">

<header>
    <h1>
        <span class="red" onclick="goToYouTube()">YouTube</span>
        <span onclick="refreshPage()"> 영상 검색</span>
    </h1>
</header>

<div class="search-container">
    <input type="text" id="query" placeholder="검색어를 입력하세요...">
    <button onclick="searchVideos(true)">검색</button>
    <button id="themeToggle">☀️</button>
</div>

<div class="results" id="results"></div>

<script>
const API_KEY = "AIzaSyAA3kRQm_Qz63VXnaXBfrFd_I1ncVee3Js"; // 여기에 유효한 API 키 넣기
let currentQuery = "";
let nextPageToken = "";

function searchVideos(reset = false) {
    const queryInput = document.getElementById("query").value.trim();
    if (reset) {
        currentQuery = queryInput;
        nextPageToken = "";
        document.getElementById("results").innerHTML = "";
    }
    if (!currentQuery) return;

    let url = `https://www.googleapis.com/youtube/v3/search?part=snippet&type=video&maxResults=20&q=${encodeURIComponent(currentQuery)}&key=${API_KEY}`;
    if (nextPageToken) {
        url += `&pageToken=${nextPageToken}`;
    }

    fetch(url)
        .then(res => {
            if (!res.ok) throw new Error(`HTTP Error: ${res.status}`);
            return res.json();
        })
        .then(data => {
            if (!data.items || data.items.length === 0) {
                console.warn("검색 결과 없음");
                return;
            }
            nextPageToken = data.nextPageToken || "";
            const results = document.getElementById("results");

            data.items.forEach(item => {
                if (!item.id || !item.id.videoId) return;
                const videoCard = document.createElement("div");
                videoCard.className = "video-card";
                videoCard.innerHTML = `
                    <a href="https://www.youtube.com/watch?v=${item.id.videoId}" target="_blank">
                        <img src="${item.snippet.thumbnails.high.url}" alt="${item.snippet.title}">
                        <h3>${item.snippet.title}</h3>
                        <p>${item.snippet.description}</p>
                    </a>
                `;
                // 미리보기
                videoCard.addEventListener("mouseenter", () => {
                    const iframe = document.createElement("iframe");
                    iframe.src = `https://www.youtube.com/embed/${item.id.videoId}?autoplay=1&mute=1`;
                    iframe.width = "100%";
                    iframe.height = "180";
                    iframe.frameBorder = "0";
                    iframe.allow = "autoplay; encrypted-media";
                    videoCard.innerHTML = "";
                    videoCard.appendChild(iframe);
                });
                videoCard.addEventListener("mouseleave", () => {
                    videoCard.innerHTML = `
                        <a href="https://www.youtube.com/watch?v=${item.id.videoId}" target="_blank">
                            <img src="${item.snippet.thumbnails.high.url}" alt="${item.snippet.title}">
                            <h3>${item.snippet.title}</h3>
                            <p>${item.snippet.description}</p>
                        </a>
                    `;
                });
                results.appendChild(videoCard);
            });
        })
        .catch(err => console.error("Error fetching videos:", err));
}

// 무한 스크롤
window.addEventListener("scroll", () => {
    if (window.innerHeight + window.scrollY >= document.body.offsetHeight - 500 && nextPageToken) {
        searchVideos(false);
    }
});

// 테마 토글
document.getElementById("themeToggle").addEventListener("click", function() {
    const body = document.body;
    const btn = this;
    btn.classList.add("rotating");
    setTimeout(() => {
        if (body.classList.contains("day-theme")) {
            body.classList.remove("day-theme");
            body.classList.add("night-theme");
            btn.textContent = "⭐";
            btn.classList.add("sparkle");
        } else {
            body.classList.remove("night-theme");
            body.classList.add("day-theme");
            btn.textContent = "☀️";
            btn.classList.remove("sparkle");
        }
    }, 300);
    setTimeout(() => btn.classList.remove("rotating"), 600);
});

function goToYouTube() {
    window.location.href = "https://www.youtube.com";
}
function refreshPage() {
    location.reload();
}
</script>

</body>
</html>
